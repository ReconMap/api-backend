<?php declare(strict_types=1);

namespace Reconmap\Models;

/**
 * Autogenerated file, do not edit manually. @see https://github.com/reconmap/model-definitions
 */
class Vulnerability implements Cleanable
{

    public ?int $id = null;
    public ?string $insert_ts = null;
    public ?string $update_ts = null;
    public ?int $creator_uid = null;
    public bool $is_template = false;
    public ?int $external_id = null;
    public ?int $project_id = null;
    public ?int $target_id = null;
    public ?int $category_id = null;
    public string $summary;
    public ?string $description;
    public ?string $external_refs = null;
    public ?string $visibility = 'public';
    public string $risk;
    public ?string $proof_of_concept = null;
    public ?string $impact = null;
    public ?string $remediation = null;
    public ?string $remediation_complexity = null;
    public ?string $remediation_priority = null;
    public ?float $cvss_score = null;
    public ?string $cvss_vector = null;
    public ?string $status;
    public ?string $substatus;
    public mixed $tags;
    public ?string $owasp_vector = null;
    public ?float $owasp_likehood = null;
    public ?float $owasp_impact = null;
    public ?string $owasp_overall = null;

    public function toArray(?array $properties = null): array
    {
        $array = (array)$this;

        if (is_null($properties)) {
            return $array;
        }

        return array_filter(
            $array,
            fn(string $key) => in_array($key, $properties),
            ARRAY_FILTER_USE_KEY
        );
    }

    public function clean(): void
    {
        if ($this->is_template) {
            $this->project_id = null;
        }
        if (0 === $this->target_id) {
            $this->target_id = null;
        }
    }
}
