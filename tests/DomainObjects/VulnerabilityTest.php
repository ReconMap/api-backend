<?php declare(strict_types=1);

namespace Reconmap\DomainObjects;

use PHPUnit\Framework\TestCase;

class VulnerabilityTest extends TestCase
{
    public function testClean()
    {
        $vulnerability = new Vulnerability();
        $vulnerability->is_template = true;
        $vulnerability->project_id = 1;
        $vulnerability->target_id = 0;
        $vulnerability->clean();

        $this->assertNull($vulnerability->project_id);
        $this->assertNull($vulnerability->target_id);
    }

    public function testToArray()
    {
        $vulnerability = new Vulnerability();
        $vulnerability->description = 'Test project';
        $vulnerability->project_id = 5;

        $this->assertEquals(['project_id' => 5], $vulnerability->toArray(['project_id']));
    }
}
